<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
   <title>Document</title>
   <link rel="stylesheet" href="../resources/css/reset.css">
   <link rel="stylesheet" href="../resources/css/style.css">
</head>
<body>
   <div id="container">
      <section class="game__RPS">
         <h2 class="game__tit">ê°€ìœ„ë°”ìœ„ë³´</h2>
         <div class="game__board">
            <div class="box__random">
               <div class="box__icon" data-icon="âœŠ"></div>
            </div>
            <div class="box__versus"><span>VS</span></div>
            <ul class="box__choice">
               <li class="scissors" data-rps="SCI">âœŒ</li>
               <li class="rock" data-rps="ROC">âœŠ</li>
               <li class="paper" data-rps="PAP">ğŸ–</li>
            </ul>
         </div>
         <div class="game__result">
            ê²°ê³¼ :&nbsp;<span></span>
            <button class="game__refresh" type="button">ë‹¤ì‹œí•˜ê¸°</button>
         </div>
      </section>
      <div class="game__board game__list__wrap">
         <ul class="game__list">
            <li><a href="../../">ê²Œì„ì—°ìŠµì¥</a></li>
            <li><a href="../../game_match/html/">ì§ ë§ì¶”ê¸° ê²Œì„</a></li>
         </ul>
      </div>
   </div>
   <script>
      var $timer;
      var $stop;
      var $icons = ['âœŒ','âœŠ','ğŸ–']
      var $iconLenght = $icons.length;
      var $stopIcon = $('.box__icon');
      var $choiceIcon = $('.box__choice li');
      var $refresh = $('.game__refresh');
      var $result = $('.game__result').find('span');
      var $myIcon;
      var $opponentIcon;
      
      //ì²˜ìŒ ì‹¤í–‰
      randomIcon();

      //ë‹¤ì‹œí•˜ê¸° í´ë¦­ ì´ë²¤íŠ¸
      $refresh.click(function(){
         if($stop){
            $('.icon_text').remove();
            $result.text('');
            $refresh.stop().hide();
            randomIcon();
         }
      })

      //ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      $choiceIcon.click(function(){
         $myIcon = $(this).attr('data-rps');
         if(!$stop){
            stopIcon();
            compareIcons();
            $refresh.stop().show();
            $stop = true;
         }
      })

      //ë¹„êµí•˜ê¸°
      function compareIcons(){
         switch ($opponentIcon) {
            case 'ROC':
               if($myIcon =='ROC'){
                  $result.text('ë¹„ê¹€');
               }else if($myIcon =='SCI'){
                  $result.text('LOSE');
               }else if($myIcon =='PAP'){
                  $result.text('WIN');
               }
               break;
            case 'SCI':
               if($myIcon =='ROC'){
                  $result.text('WIN');
               }else if($myIcon =='SCI'){
                  $result.text('ë¹„ê¹€');
               }else if($myIcon =='PAP'){
                  $result.text('LOSE');
               }
               break;
            case 'PAP':
               if($myIcon =='ROC'){
                  $result.text('LOSE');
               }else if($myIcon =='SCI'){
                  $result.text('WIN');
               }else if($myIcon =='PAP'){
                  $result.text('ë¹„ê¹€');
               }
               break;
            default :
               break;
         }
      }
     
      //ëœë¤ìœ¼ë¡œ ë©ˆì¶”ê³  ê°’ë°›ê¸°
      function stopIcon(){
         stopTimer($timer);
         var $ranNum = Math.random();
         var $random = Math.floor($ranNum *$iconLenght);
         switch ($random) {
            case 0 :
               $stopIcon.attr('data-icon','âœŒ');
               $opponentIcon = 'SCI';
               printOpp('ê°€ìœ„');
               break;
            case 1 :
               $stopIcon.attr('data-icon','âœŠ');
               $opponentIcon = 'ROC';
               printOpp('ë°”ìœ„');
               break;
            case 2 :
               $stopIcon.attr('data-icon','ğŸ–');
               $opponentIcon = 'PAP';
               printOpp('ë³´');
               break;
            default :
               break;
         }
      }
      
      //ì•„ì´ì½˜ ì´ë¦„ ì¶œë ¥
      function printOpp($txt){
         var $div = $('<div class="icon_text">'+ $txt +'</div>');
         $('.box__random').append($div);
      }

      //ì•„ì´ì½˜ ëŒë¦¬ê¸° ë©ˆì¶”ê¸°
      function stopTimer(timer){
         clearInterval(timer);
         $stop=true;
      }
   
      //ì•„ì´ì½˜ ëŒë¦¬ê¸°
      function randomIcon(){
         var $cnt = 0;
         $timer = setInterval(function(){
            $stopIcon.attr('data-icon',$icons[$cnt])
            $cnt++;
            if($cnt == $iconLenght){
               $cnt = 0;
            }
         }, 100);
         $stop = false;
      }
   </script>
</body>
</html>